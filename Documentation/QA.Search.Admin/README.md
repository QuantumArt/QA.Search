# QP Search Admin

Приложение является веб-интерфейсом по мониторингу и управлению индексацией данных через QP Search Integration.  
Приложение поддерживает аутентификацию по логину и паролю.  

## Аутентификация

Приложение поддерживает аутентификацию по логину и паролю, а так же ролевую модель.  
Роль `Admin` позволяет управлять пользователями и имеет доступ ко всем функциям приложения.  
Роль `User` имеет доступ ко всем функциям приложения, но не имеет возможности управлять пользователями.  

## Пользователи

Раздел `Пользователи` позволяет пользователю с ролью администратора управлять другими учётными записями приложения.
Возможно создание пользователей, удаление пользователей, восстановление пароля через одноразовую ссылку отправляемую по электронной почте.  
Так же в интерфейсе предусмотрена фильтрация выдачи списка пользователей.

## Индексы Elastic

Данная страница предназначена для мониторинга состояния индексов.  
На странице расположены карточки объектов индексации, на которых отображаются:  
1. Имя объекта;  
2. Состояние (слева от имени);  
3. Информация об индексе;  
   1. Название индекса;  
   2. Alias;  
   3. Дата создания индекса.  

Так же на карточке индекса доступы следующие действия:  
1. Удаление индекса;  
2. Запуск процесса переиндексации.  

Под переиндексацией тут имеется ввиду создание нового индекса в ElasticSearch средствами самого ES, переключение alias-а на новый индекс и удаление старого индекса. Данные индекса берутся из старого индекса, а не обновляются из источника данных. Использовать данную функцию имеет смысл, если был изменён шаблон индекса и надо переиндексировать те же данные, но согласно новому шаблону. Эта операция проходит быстрее и с меньшими рисками, чем полная переиндексация из источника данных.  

Помимо карточек объектов индексации на странице присутствует функциональность фильтрации списка карточек по имени, а так же возможность создать новый (пустой) индекс.  

## Шаблоны Elastic

Шаблоны Elastic показывают доступные шаблоны сохранённые в приложении (на диске) и прописанные в ES. Сохранённые шаблоны отображаются зелёным цветом, шаблоны загруженные из ES - красным.  
При выборе шаблона в области со списком шаблонов тело шаблона отображается области с соответствующим именованием.  
В данный момент реализована только функциональность просмотра, без возможности редактирования и применения шаблонов в ES.

## Индексация QP

Данный раздел показывает состояние индексации и содержит два основных блока:  
1. Карточку состояния полной индексации;  
2. Блок с карточками состояния каждого объекта индексации.  

Так же данная страница представлена в двух подвидах:  
1. QP - полная индексация всех данных из источника данных;  
2. QP Update - частичная индексация (индексирует только изменения с даты последней индексации).

### Карточка состояния полной индексации

На данной карточке показаны:  
1. Статус индексации;  
2. Последнее сообщение от сервиса индексации;  
3. Дата начала последней индексации;  
4. Дата завершения последней индексации;  
5. Список дат последующих запусков полной индексации;  
6. Кнопка принудительного запуска полной индексации.  

Кнопка принудительного запуска полной индексации запускает внеочередную полную индексацию данных из источника данных в ElasticSearch.  
В отличии от схожего механизма описанного в разделе `Индексы Elastic` в этом случае индексируются не конкретные объекты, а вообще все объекты подлежащие индексации. Так же данные берутся не из старого индекса, а загружаются из источника данных, что ведёт к полной актуализации всех изменений с момента последней индексации. Так же, если в шаблон индекса были внесены изменения, то новый индекс будет построен согласно правилами, указанным в новом шаблоне.  

### Блок с карточками состояния объектов индексации

Данный блок содержит отчёт об индексации для каждого объекта индексации.  
Отчёт содержит следующие данные:  
1. Название индекса - это не полное название индекса, а название объекта индексации;  
2. Размер партии - кол-во данных которые выбираются из источника данных за один заход;  
3. Время загрузки продуктов - сколько времени затрачено на загрузку данных из источника данных;  
4. Время обработки продуктов - сколько времени затрачено на подготовку данных к индексации (формирование запроса для индексации, очистка объекта от лишних данных (html-тегов и прочего) и так далее);  
5. Время индексации продуктов - сколько времени затрачено на загрузку данных в ElasticSearch согласно шаблону индексации;  
6. Кол-во найденных продуктов - кол-во данных, которые были найдены в источнике данных для индексации;  
7. Продуктов загружено - кол-во данных, которые были загружены из источника данных для индексации;  
8. ПРодуктов проиндексировано - кол-во данных, которые были успешно сохранены в индексе ElasticSearch;  
9. Продуктов не проиндексировано - кол-во данных, которые не удалось сохранить в ElasticSearch (например из-за ошибки).  
